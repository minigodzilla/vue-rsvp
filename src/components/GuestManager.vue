<template>
	<div class="overlay">
		<svg viewBox="0 0 373.5 281.1">
			<path
				d="M66.6,8.8v99.5c0,11.7-3.4,21.2-10.3,28.5c-6.9,7.3-16.1,11-27.7,11c-7.7,0-14.4-2.3-20.1-6.9C2.8,136.1,0,130.1,0,122.6
	c0-5.5,2-10.2,6.1-14.1c4.1-3.9,8.9-5.9,14.5-5.9v3.1c-4.6,0-8.7,1.7-12.1,5C5,114,3.3,118,3.3,122.6c0,6.4,2.4,11.6,7.3,15.7
	c4.8,4.1,10.5,6.1,17,6.1c10.9,0,19.6-3.3,26-9.8c6.4-6.6,9.7-15.3,9.7-26.4V8.8c0-1.5-0.6-2.8-1.7-3.9c-1.1-1-2.4-1.6-4-1.6h-2.3V0
	h18.5v3.3H72c-1.5,0-2.8,0.6-3.9,1.7C67.1,6.1,66.6,7.3,66.6,8.8z"
			/>
			<path
				d="M81,81.6c-0.3,1.1-0.5,2.3-0.5,3.6c0,5.2,2.2,9.4,6.6,12.6c4.4,3.2,9.3,4.9,14.7,4.9c7.3,0,13.4-2.8,18.3-8.3l2.5,2.1
	c-5.7,6.3-12.7,9.4-20.8,9.4c-6.3,0-12-1.9-17-5.8c-5.1-3.9-7.6-8.9-7.6-15c0-6.2,2.5-11.2,7.6-15c5.1-3.9,10.7-5.8,17-5.8
	c8.7,0,15.4,3.1,20,9.4c1.7,2.1,2.8,4.7,3.5,7.8H81z M82.3,78.3h38.2c-3.7-7-10-10.6-18.7-10.6c-4,0-7.8,0.9-11.5,2.8
	C86.6,72.4,83.9,75,82.3,78.3z"
			/>
			<path
				d="M136.3,104.4v-3.3h9.6V69.9h-10.1v-3.1h13.4V73c2.3-2.6,5.5-4.7,9.4-6.2c4-1.5,7.7-2.2,11.2-2.2c6.1,0,10.7,2.3,14,6.8
	c1.7,2.4,2.5,5,2.5,7.8c0,2.8-0.7,5.3-2,7.8l-6.8,14.2h14v3.3h-18v-3.1l7.9-15.7c1-2,1.5-4.1,1.5-6.3c0-2.3-0.6-4.3-1.8-5.9
	c-2.9-3.7-6.7-5.6-11.4-5.6c-4.2,0-8.5,1.1-13.1,3.4c-4.5,2.3-7.1,5.3-7.6,9v21h9.6v3.3H136.3z"
			/>
			<path
				d="M202.7,104.4v-3.3h9.6V69.9h-10.1v-3.1h13.4V73c2.3-2.6,5.5-4.7,9.4-6.2c4-1.5,7.7-2.2,11.2-2.2c6.1,0,10.7,2.3,14,6.8
	c1.7,2.4,2.5,5,2.5,7.8c0,2.8-0.7,5.3-2,7.8l-6.8,14.2h14v3.3h-18v-3.1l7.9-15.7c1-2,1.5-4.1,1.5-6.3c0-2.3-0.6-4.3-1.8-5.9
	c-2.9-3.7-6.7-5.6-11.4-5.6c-4.2,0-8.5,1.1-13.1,3.4c-4.5,2.3-7.1,5.3-7.6,9v21h9.6v3.3H202.7z"
			/>
			<path
				d="M166.4,159.2c-0.9-7.8-4.9-14-12.1-18.4c-7.2-4.5-14.9-6.7-23.1-6.7c-8.6,0-16.6,2.5-24,7.4c-7.4,5-11.2,11.5-11.2,19.7
	c0,5,1.5,9.4,4.6,13.3c3.1,3.9,7.1,7.2,12,9.8c4.9,2.6,10.3,5.2,16.3,7.6c5.9,2.4,11.9,5,17.8,7.8c5.9,2.8,11.4,5.8,16.3,9.2
	c4.9,3.4,8.9,7.7,12,13c3.1,5.3,4.6,11.3,4.6,18c0,12.1-4.9,22-14.7,29.7c-9.8,7.7-20.9,11.6-33.2,11.6c-5.7,0-11.3-0.7-16.9-2
	c-5.5-1.3-10.7-3.3-15.6-6c-4.9-2.7-8.8-6.4-11.8-11.2c-3-4.7-4.5-10.2-4.5-16.4c0-7.2,2.9-13,8.6-17.6c5.7-4.6,12.2-6.9,19.5-6.9
	c5,0,9.7,1.1,14.1,3.4c4.5,2.3,8,5.4,10.5,9.3l-2.6,1.8c-2.3-3.5-5.5-6.3-9.5-8.3c-4-2-8.2-3-12.5-3c-6.4,0-12.1,2-17.2,5.9
	c-5.1,4-7.6,9-7.6,15.2c0,5.6,1.4,10.6,4.2,15c2.8,4.3,6.5,7.7,11.2,10.2c4.6,2.4,9.5,4.2,14.5,5.4c5.1,1.2,10.2,1.7,15.5,1.7
	c11.5,0,21.8-3.6,30.9-10.7c9.1-7.1,13.7-16.2,13.7-27.3c0-6.4-1.5-12.1-4.6-17c-3.1-5-7.1-9-12-12.2c-4.9-3.2-10.3-6.1-16.3-8.8
	c-5.9-2.6-11.9-5.2-17.8-7.7c-5.9-2.5-11.4-5.1-16.3-7.9c-4.9-2.8-8.9-6.3-12-10.6c-3.1-4.2-4.6-9.1-4.6-14.5c0-9.1,4-16.5,12.1-22
	c8-5.5,16.9-8.3,26.4-8.3c6.5,0,12.8,1.3,19,4c6.2,2.6,11,6.4,14.5,11.2l-1.3-12.1l3.1-0.3l3,24.9L166.4,159.2z"
			/>
			<path
				d="M188.2,155.1c2.9,0,5.3,1,7.4,3.1c2.1,2.1,3.1,4.6,3.1,7.4v33.2h9.3v3.3h-9.3v24.1c0,2,0.7,3.7,2.1,5c1.4,1.4,3.1,2.1,5,2.1
	h1.7v3.3h-1.7c-2.9,0-5.3-1-7.4-3.1c-2-2-3.1-4.5-3.1-7.4v-24.1h-7.6v-3.3h7.6v-33.2c0-2-0.7-3.7-2.1-5.1c-1.4-1.4-3.1-2.1-5.1-2.1
	V155.1z"
			/>
			<path
				d="M222.4,213.9c-0.3,1.1-0.5,2.3-0.5,3.6c0,5.2,2.2,9.4,6.6,12.6c4.4,3.2,9.3,4.9,14.7,4.9c7.3,0,13.4-2.8,18.3-8.3l2.5,2.1
	c-5.7,6.3-12.7,9.4-20.8,9.4c-6.3,0-12-1.9-17-5.8c-5.1-3.9-7.6-8.9-7.6-15c0-6.2,2.5-11.2,7.6-15c5.1-3.9,10.7-5.8,17-5.8
	c8.7,0,15.4,3.1,20,9.4c1.7,2.1,2.8,4.7,3.5,7.8H222.4z M223.8,210.6h38.2c-3.7-7-10-10.6-18.7-10.6c-4,0-7.8,0.9-11.5,2.8
	C228.1,204.7,225.4,207.3,223.8,210.6z"
			/>
			<path
				d="M282.9,202.2c-1.5,3.2-2.3,7-2.3,11.4c0,5.1,1.4,9.9,4.1,14.5c2.8,4.6,6.5,6.9,11.2,6.9c4.8,0,8.6-2.3,11.4-6.9
	c2.8-4.6,4.1-9.5,4.1-14.5c0-6.9-1.7-14.5-5-22.6l3-1.2c3.5,9.3,5.3,17.2,5.3,23.8c0,5.9-1.7,11.6-5.1,16.9c-3.4,5.3-8,7.9-13.7,7.9
	c-5.6,0-10.1-2.6-13.5-7.9c-3.4-5.3-5.1-10.9-5.1-16.9c0-3.6,0.6-7.4,1.8-11.2H272v-3.5h10.9V202.2z"
			/>
			<path
				d="M329.2,213.9c-0.3,1.1-0.5,2.3-0.5,3.6c0,5.2,2.2,9.4,6.6,12.6c4.4,3.2,9.3,4.9,14.7,4.9c7.3,0,13.4-2.8,18.3-8.3l2.5,2.1
	c-5.7,6.3-12.7,9.4-20.8,9.4c-6.3,0-12-1.9-17-5.8c-5.1-3.9-7.6-8.9-7.6-15c0-6.2,2.5-11.2,7.6-15c5.1-3.9,10.7-5.8,17-5.8
	c8.7,0,15.4,3.1,20,9.4c1.7,2.1,2.8,4.7,3.5,7.8H329.2z M330.5,210.6h38.2c-3.7-7-10-10.6-18.7-10.6c-4,0-7.8,0.9-11.5,2.8
	C334.8,204.7,332.1,207.3,330.5,210.6z"
			/>
			<path
				d="M271.8,146.8c0,1.2-0.3,2.3-1,3.1c-0.6,0.8-1.4,1.5-2.1,1.8c-0.8,0.4-1.8,0.8-3.2,1.1c1,1.6,1.6,3.2,1.6,5.1
	c0,1.7-0.5,3.4-1.4,4.8c-0.9,1.5-2.1,2.6-3.5,3.5c-1.4,0.9-3,1.6-4.6,2c-1.6,0.5-3.2,0.7-4.8,0.7c-3.6,0-6.8-1.1-9.6-3.2
	c-2.7-2.2-4.1-5-4.1-8.6c0-2.2,0.5-4.2,1.6-6c1.1-1.8,2.6-3.1,4.5-4c-2.1-1.2-3.1-2.9-3.1-5.1c0-1.9,0.8-3.4,2.3-4.6
	c1.5-1.2,3.2-1.8,5.1-1.8h8c0.5,0,1-0.8,1.4-2.3l2.6,2.1c-0.4,1-0.9,1.7-1.7,2.3c-0.7,0.6-1.5,0.9-2.4,0.9h-8c-1.1,0-2.1,0.3-3,1
	c-0.9,0.6-1.4,1.5-1.4,2.5c0,1.3,0.8,2.3,2.4,3l6.7,2.8l-1,2.8c-1.1-0.8-2.3-1.2-3.6-1.2c-1.9,0-3.7,0.8-5.2,2.3
	c-1.5,1.6-2.2,3.4-2.2,5.4c0,2.7,1.1,4.8,3.2,6.4c2.1,1.6,4.6,2.4,7.5,2.4c2.7,0,5.3-0.7,7.7-2.2c2.4-1.4,3.6-3.4,3.6-5.9
	c0-1.6-0.5-3-1.6-4.1c-2.2,0.7-3.4,1.7-3.4,3.2c0,0.6,0.3,1.2,0.9,1.7c0.6,0.5,1.4,0.9,2.3,1.2l-0.9,2.9c-1.6-0.5-2.8-1.2-3.8-2.3
	c-1-1.1-1.5-2.3-1.5-3.5c0-0.9,0.2-1.7,0.5-2.3c0.3-0.7,0.7-1.2,1.1-1.7c0.4-0.4,1-0.8,1.8-1.2c0.8-0.4,1.4-0.7,2-0.8
	c0.5-0.2,1.3-0.4,2.2-0.7c0.8-0.2,1.5-0.4,1.9-0.6c0.5-0.2,1-0.4,1.6-0.7c0.6-0.3,1-0.6,1.3-0.9c0.3-0.4,0.4-0.8,0.4-1.3
	c0-0.6-0.2-1.1-0.6-1.5c-0.4-0.4-0.9-0.7-1.4-0.7c-0.4,0-1.1,0.3-2.1,1l-1.6-2.5c1.4-1,2.6-1.6,3.6-1.6c1.4,0,2.6,0.5,3.6,1.5
	C271.4,144.2,271.8,145.4,271.8,146.8z"
			/>
		</svg>
		<p>Loading your invitation...</p>
	</div>
	<div class="book">
		<div class="spread spread-welcome" :class="{ active: step == 1, complete: guest.hasOwnProperty('accepts') && guest.accepts != '', passed: step > 1 }">
			<div class="page right">
				<img draggable="false" class="img img-small img-flourish" src="/assets/flourish-1.jpg" />
				<div class="body-text">
					<h4>Greetings {{ guest.firstName }}!</h4>
					<p>Do you accept your invitation?</p>
					<div class="input-row">
						<input type="radio" name="accepts" value="veg" id="accepts-yes" v-model="guest.meal" ref="accepts" />
						<label for="accepts-yes">Yes</label>
						<input type="radio" name="accepts" value="beef" id="accepts-no" v-model="guest.meal" ref="accepts" />
						<label for="accepts-no">No</label>
					</div>
				</div>
				<button class="page-turn" v-on:click="next('alcohol')">
					<img draggable="false" src="/assets/page-turn.svg" />
				</button>
				<div class="page-turn-tip" v-on:click="next('alcohol')">Turn the page to continue.</div>
			</div>
		</div>
		<div class="spread spread-meal" :class="{ active: step == 2, complete: guest.hasOwnProperty('meal') && guest.meal != '', passed: step > 2 }">
			<div class="page left" v-on:click="prev">
				<img draggable="false" class="img img-full" src="/assets/beatrix-1.jpg" />
			</div>
			<div class="page right">
				<div class="body-text">
					<h4>What is {{ guest.firstName }}'s meal preference?</h4>
					<div class="input-row">
						<input type="radio" name="meal" value="veg" id="meal-veg" v-model="guest.meal" ref="meal" />
						<label for="meal-veg">Vegetarian</label>
						<input type="radio" name="meal" value="beef" id="meal-beef" v-model="guest.meal" />
						<label for="meal-beef">Beef</label>
						<input type="radio" name="meal" value="chicken" id="meal-chicken" v-model="guest.meal" />
						<label for="meal-chicken">Chicken</label>
					</div>
				</div>
				<div class="body-text" :class="{ hidden: guest.meal === '', shown: guest.meal != '' }">
					<h4>Any dietary notes? (allergies, restrictions, etc.?)</h4>
					<div class="input-row">
						<textarea spellcheck="false" v-model="guest.dietaryNotes"></textarea>
					</div>
				</div>
				<button class="page-turn" v-on:click="next('alcohol')">
					<img draggable="false" src="/assets/page-turn.svg" />
				</button>
				<div class="page-turn-tip" v-on:click="next('alcohol')">Turn the page to continue.</div>
			</div>
		</div>
		<div class="spread spread-alcohol" :class="{ active: step == 3, complete: guest.hasOwnProperty('alcoholPref') && guest.alcoholPref != '', passed: step > 3 }">
			<div class="page left" v-on:click="prev('meal')">
				<img draggable="false" class="img img-full" src="/assets/pooh-1.jpg" />
			</div>
			<div class="page right">
				<div class="body-text">
					<h4>What is {{ guest.firstName }}'s preference for alcoholic drinks?</h4>
					<div class="input-row">
						<input type="radio" name="alcohol" value="none" id="alcohol-none" v-model="guest.alcoholPref" ref="alcohol" />
						<label for="alcohol-none">None</label>
						<input type="radio" name="alcohol" value="beer" id="alcohol-beer" v-model="guest.alcoholPref" />
						<label for="alcohol-beer">Beer</label>
						<input type="radio" name="alcohol" value="wine" id="alcohol-wine" v-model="guest.alcoholPref" />
						<label for="alcohol-wine">Wine</label>
					</div>
				</div>
				<button class="page-turn" v-on:click="modifyGuest">
					<img draggable="false" src="/assets/page-turn.svg" />
				</button>
				<div class="page-turn-tip" v-on:click="modifyGuest">Turn the page to continue.</div>
			</div>
		</div>
		<div class="spread spread-thank-you" :class="{ active: step == 4 }">
			<div class="page left" v-on:click="prev">
				<img draggable="false" class="img img-full" src="/assets/birds.jpg" />
			</div>
			<div class="page right">
				<img draggable="false" class="img img-small img-flourish" src="/assets/flourish-1.jpg" />
				<div class="body-text">
					<h3>Thank you!</h3>
					<p>We have your RSVP.</p>
					<p>You may return at any time to make changes.</p>
					<p>We can't wait to see you!</p>
				</div>
				<img draggable="false" class="img img-small img-flourish" src="/assets/flourish-2.jpg" />
			</div>
		</div>
	</div>
</template>

<style lang="scss">
.overlay {
	opacity: 0;
	pointer-events: none;
	position: absolute;
	z-index: 10;
	top: 0;
	right: 0;
	bottom: 0;
	left: 0;
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	background-color: rgba(0, 0, 0, 0.75);
	color: #9c8264;

	svg {
		width: 25vw;
		fill: #9c8264;
		margin-bottom: 1em;
	}
}
.book {
	transition: filter 200ms ease;
	// filter: blur(2em);
	position: relative;
	background: #393617;
	width: 85vw;
	height: 50vw;
	perspective: 200vw;
	border-radius: 0.5vw;
	box-shadow: 1.5vw 0.75vw 2vw #000, inset 0.125vw 0.125vw 0.1vw #757154, inset -0.125vw -0.125vw 0.1vw #0e0a07, inset -1vw -1vw 2vw rgba(0, 0, 0, 0.5);

	&::before {
		content: '';
		position: absolute;
		top: 0;
		right: 0;
		bottom: 0;
		left: 0;
		background-image: url('/assets/leather.jpg');
		background-size: 15vw;
		mix-blend-mode: soft-light;
		border-radius: 0.5vw;
	}

	.spread {
		position: absolute;
		z-index: 1;
		top: 1vw;
		right: 1vw;
		bottom: 1vw;
		left: 1vw;
		transition: z-index 2s cubic-bezier(0.645, 0.045, 0.355, 1);

		.page {
			backface-visibility: hidden;
			position: absolute;
			top: 0;
			bottom: 0;
			width: 50%;
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			transform: rotateY(0deg);
			transform-origin: 0% 0%;
			filter: brightness(0.9) contrast(1.1);
			transition-property: transform, filter, clip-path;
			transition-delay: 0s;
			transition-duration: 2s;
			transition-timing-function: cubic-bezier(0.645, 0.045, 0.355, 1);

			&.left {
				left: 0;
				background-image: linear-gradient(to left, #8f7c5f 0%, #ae9776 12.5%, #bea683 50%, #bea684 100%);
				transform-origin: 100% 0;
				transform: rotateY(180deg);
				z-index: 1;
			}

			&.right {
				right: 0;
				background-image: linear-gradient(to right, #a89373 0%, #c1aa87 1%, #c0a885 12.5%, #a28c6c 50%, #a58e6e 100%);
				clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 100% 100%, 0% 100%);
			}

			> div,
			> img {
				user-select: none;
			}

			> div,
			> img,
			> input,
			> button {
				mix-blend-mode: multiply;
			}

			button {
				width: 25%;
				padding: 0;
				border: 0 none;
				background: transparent;
			}

			.img-small {
				display: block;
				margin: 0 auto;
				width: 100%;
			}

			.img-flourish {
				width: 30%;
				margin: 1em 0;
			}

			.img-full {
				max-height: 85%;
				max-width: 100%;
			}

			@keyframes reveal-form-field {
				0% {
					height: 0;
					opacity: 0;
				}
				50% {
					height: 12em;
					opacity: 0;
				}
				100% {
					height: 12em;
					opacity: 1;
				}
			}

			.body-text {
				max-width: 35vw;
				text-align: center;
				margin: 1em 0;

				h4 {
					margin-top: 1em;
					margin-bottom: 1em;
				}

				&.hidden {
					height: 0;
					opacity: 0;
				}

				&.shown {
					animation-name: reveal-form-field;
					animation-duration: 1s;
					animation-timing-function: ease;
					animation-fill-mode: forwards;
				}
			}

			.error-message {
				color: #f00;
				height: 1em;
				margin-top: 1em;
				font-size: 0.875em;
			}

			.input {
				appearance: none;
				font-size: 2em;
				font-family: serif;
				border-radius: 0;
				border-style: solid;
				border-width: 0.05em;
				border-color: #888;
				color: #333;
				margin: 1.5em 0;
				padding: 0;
				width: 4em;
				text-align: center;

				&.box {
					margin: 0 0 1em 0;
				}
			}

			input[type='radio'] {
				width: 0;
				height: 0;
				margin: 0;
			}

			label {
				background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Cpath d='m0 0h20v20h-20z' stroke='%23000' stroke-width='2' fill='transparent'/%3E%3C/svg%3E");
				background-position: 0 50%;
				background-repeat: no-repeat;
				background-size: 0.75em;
				padding-left: 1.25em;
				position: relative;

				@keyframes draw-in {
					0% {
						height: 0em;
					}
					100% {
						height: 0.625em;
					}
				}

				&::before,
				&::after {
					content: '';
					position: absolute;
					top: 0.325em;
					width: 0.625em;
					height: 0;
					background-size: 0.625em;
					left: 0.0625em;
					animation-duration: 0.2s;
					animation-timing-function: ease;
					animation-fill-mode: forwards;
				}

				&::before {
					animation-delay: 0.2s;
					background-image: url("data:image/svg+xml,%3Csvg enable-background='new 0 0 64 64' height='64' viewBox='0 0 64 64' width='64' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%2326f' d='m53.1 56.6c-.3-.1-.5-.1-.8-.2-.9-.3-1.9-.5-2.7-1.1-.9-.7-1.5-1.6-2.3-2.5-.3-.3-.6-.5-1-.7-.8-.6-1.6-1.1-2.4-1.7-1.4-1-2.7-2-4.1-3-.4-.4-.8-1.1-1.3-1.4-1.4-.8-2.6-1.6-3.6-2.9-.3-.3-.8-.4-1.1-.7-1.2-1.1-2.3-2.3-3.5-3.4-2.8-2.5-5.7-5-8.5-7.5-1.1-1-2.2-2.1-3.4-3.1-1.3-1.2-2.5-2.3-3.8-3.4-.3-.3-.7-.5-1-.7-1.5-.8-2.4-2.2-3.7-3.2-1.1-.9-2.1-1.7-3.2-2.5-.7-.5-1.4-.9-2.1-1.4-1-.8-1.9-1.8-2.9-2.7-.1-.1-.3-.2-.4-.4 0-.1 0-.2 0-.3.5-.9 1-1.9 1.6-2.7.4-.6 1.1-1 1.5-1.5.7-1 1.6-1.2 2.7-1.3 1.1-.3 2.2-.7 3.3-.9h.5c.8.3 1.6.5 2.2 1 1 .8 1.9 1.9 2.9 2.8.6.6 1.2 1.1 1.8 1.6 1.3 1 2.6 2 3.9 3.1 1.3 1 2.5 2.1 3.8 3.2.6.5 1.3.9 2 1.4.1.1.2.1.2.2 1 1.8 2.8 2.8 4.2 4.2 2.2 2.4 4.8 4.4 7.2 6.7 1.1 1 2.1 2.1 3.2 3.1.8.8 1.7 1.4 2.6 2.1 1.3 1.1 2.4 2.2 3.8 3.1 1 .7 2.1 1.2 3.1 1.9 1.7 1.1 3.4 2.2 5.1 3.2.6.4 1.3.6 2 .9 1.5.5 2.8 1.3 3.3 2.8.2.4.2.9.4 1.4v1.2c-.1.2-.3.4-.3.7-.2.9-.4 1.9-1.1 2.5-1 .8-2 1.7-3.4 1.7-.1 0-.2.1-.3.2-1.5.2-3 .2-4.4.2z'/%3E%3C/svg%3E");
				}

				&::after {
					background-image: url("data:image/svg+xml,%3Csvg enable-background='new 0 0 64 64' height='64' viewBox='0 0 64 64' width='64' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%2326f' d='m55.1 10.9c-.1.3-.2.6-.3 1-.2.5-.4.8-.9 1.1-.7.5-1.2 1.2-1.7 1.9-.9 1.1-1.6 2.3-2.5 3.4-.7.7-1.5 1.2-2.3 1.7-.6.5-1.4.8-2 1.3-.5.3-.8.8-1.2 1.2-1.1 1.2-2.2 2.3-3.2 3.5-.8.8-1.5 1.7-2.2 2.6-1 1.1-2 2.3-2.8 3.5-1.2 1.7-2.5 3.2-3.9 4.7-1 1.1-1.7 2.3-2.6 3.5-.7.9-1.4 1.8-2.1 2.7-.7 1-1.4 2-2.1 3-.5.8-1.3 1.5-1.6 2.3-.6 1.4-1.6 2.4-2.9 3.3-.3.2-.5.7-.8 1-.2.2-.2.5-.4.7-1.5 1-2.9 2-4.8 2.1-1.2.1-2.4.2-3.7.4-.1 0-.1.1-.2.2-.2 0-.4 0-.7 0-.1-.1-.2-.1-.3-.2-1.1-.3-2.2-.7-2.8-1.8-.3-.6-.6-1.3-.9-1.9 0-.3 0-.7 0-1 .8-.3 1.3-.8 1.5-1.7 0-.2.2-.4.4-.5.8-.6 1.6-1.1 2.3-1.6 1.1-.9 2.1-1.8 3.2-2.7.5-.4.9-.9 1.4-1.4.1-.1.1-.2.2-.2.8-1.3 1.7-2.6 2.6-3.9.7-1 1.6-1.9 2.3-2.8 1.1-1.5 2.1-3 3.2-4.4s2.4-2.7 3.6-4.1c.8-.9 1.6-1.8 2.3-2.8 1.2-1.7 2.5-3.3 4.2-4.7.6-.5 1.1-1.3 1.6-1.9 1-1.1 2.3-2.1 3.1-3.3 1.2-1.9 3.2-2.8 4.8-4.1 1.2-.9 2.3-1.8 3.6-2.6 1-.6 1.9-1.4 3.3-1.1.5.1 1.1-.4 1.7-.6h.5c.9.2 1.4.7 1.8 1.5.3.6.8 1.1 1.2 1.7.1.3.1.7.1 1z'/%3E%3C/svg%3E");
				}
			}

			input[type='radio']:checked + label {
				&::before,
				&::after {
					animation-name: draw-in;
				}
			}

			input:focus,
			textarea:focus,
			button:focus,
			input[type='radio']:focus + label {
				outline: none !important;
				box-shadow: none !important;
				// background-color: red;
			}

			textarea {
				resize: none;
				width: 100%;
				height: 6em;
				background-color: transparent;
				background-image: url('/assets/textarea.svg');
				background-repeat: repeat;
				background-size: 2em;
				border: 0 none;
				margin-top: -0.5em;
				padding: 0 0.25em;
				font-family: 'homemade apple', script;
				font-size: 1em;
				line-height: 2em;
				color: #26f;
				text-align: center;
				overflow: hidden;
				display: block;
				box-sizing: border-box;
			}

			label {
				margin-right: 1em;

				&:last-of-type {
					margin-right: 0;
				}
			}

			.page-turn {
				cursor: pointer;
				position: absolute;
				width: 70%;
				mix-blend-mode: soft-light;
				right: 0;
				bottom: 0;
				transform: scale(0);
				transform-origin: 100% 100%;
				transition-property: transform;
				transition-duration: 2s;
				transition-timing-function: cubic-bezier(0.645, 0.045, 0.355, 1);
				transition-delay: 0s;

				img {
					display: block;
					width: 100%;
				}
			}

			@keyframes page-turn-tip-reveal {
				from {
					opacity: 0;
				}
				to {
					opacity: 0.8;
				}
			}

			@keyframes page-turn-tip-hide {
				from {
					opacity: 0.8;
				}
				to {
					opacity: 0;
				}
			}

			@keyframes page-turn-tip-breathe {
				from {
					opacity: 0.2;
				}
				to {
					opacity: 0.8;
				}
			}

			.page-turn-tip {
				position: absolute;
				width: 100%;
				bottom: 2em;
				font-size: 0.875em;
				text-align: center;
				opacity: 0;
				animation-direction: normal, alternate-reverse;
				animation-duration: 1s, 1s;
				animation-iteration-count: 1, infinite;
				animation-timing-function: ease, linear;
			}
		}
	}

	.spread {
		&.active {
			z-index: 3;

			.page {
				filter: none;
			}

			.page.left {
				transform: rotateY(0deg);
			}
		}
		&.active + .spread {
			z-index: 2;
		}
		&.complete {
			.page-turn-tip {
				animation-name: page-turn-tip-reveal, page-turn-tip-breathe;
				animation-delay: 1s, 2s;
			}
		}
		&.active.complete {
			.page-turn {
				transform: scale(1);
			}
			.page.right {
				clip-path: polygon(0% 0%, 100% 0%, 100% 87.25%, 63% 100%, 0% 100%);
			}
		}
		&.passed {
			z-index: 2;

			.page.left {
				transform: rotateY(0deg);
			}
			.page.right {
				transform: rotateY(-180deg);
			}
		}
	}

	// &.show-1 {
	//   .spread-1 {
	//     z-index: 3;

	//     .page {
	//       filter: none;
	//     }

	//     .page.left {
	//       transform: rotateY(0deg);
	//     }
	//   }
	//   .spread-2 {
	//     z-index: 2;
	//   }
	// }

	// &.show-2 {
	//   .spread-1 {
	//     z-index: 2;

	//     .page.left {
	//       transform: rotateY(0deg);
	//     }

	//     .page.right {
	//       transform: rotateY(-180deg);
	//     }

	//     .page-turn {
	//       animation-name: page-turn-reveal, page-turn-breathe;
	//     }

	//     .page-turn-tip {
	//       animation-name: page-turn-tip-reveal, page-turn-tip-breathe;
	//     }
	//   }
	//   .spread-2 {
	//     z-index: 3;

	//     .page { filter: none; }

	//     .page.left {
	//       transform: rotateY(0deg);
	//     }

	//     .page-turn {
	//       animation-name: page-turn-reveal, page-turn-breathe;
	//     }

	//     .page-turn-tip {
	//       animation-name: page-turn-tip-reveal, page-turn-tip-breathe;
	//     }
	//   }
	//   .spread-3 {
	//     z-index: 2;

	//     .page.right {
	//       transform: rotateY(0deg);
	//     }
	//   }
	// }

	// &.show-3 {
	//   .spread-1 {
	//     z-index: 2;

	//     .page.left {
	//       transform: rotateY(0deg);
	//     }

	//     .page.right {
	//       transform: rotateY(-180deg);
	//     }

	//     .page-turn {
	//       animation-name: page-turn-reveal, page-turn-breathe;
	//     }

	//     .page-turn-tip {
	//       animation-name: page-turn-tip-reveal, page-turn-tip-breathe;
	//     }
	//   }
	//   .spread-2 {
	//     z-index: 2;

	//     .page.left {
	//       transform: rotateY(0deg);
	//     }

	//     .page.right {
	//       transform: rotateY(-180deg);
	//       clip-path: polygon(0% 0%, 100% 0%, 100% 86.5%, 64.5% 100%, 0% 100%);
	//     }

	//     .page-turn {
	//       animation-name: page-turn-reveal, page-turn-breathe;
	//     }

	//     .page-turn-tip {
	//       animation-name: page-turn-tip-reveal, page-turn-tip-breathe;
	//     }
	//   }
	//   .spread-3 {
	//     z-index: 3;

	//     .page { filter: none; }

	//     .page.left {
	//       transform: rotateY(0deg);
	//     }

	//     .page-turn {
	//       animation-name: page-turn-reveal, page-turn-breathe;
	//     }

	//     .page-turn-tip {
	//       animation-name: page-turn-tip-reveal, page-turn-tip-breathe;
	//     }
	//   }
	// }

	// &.show-4 {
	//   .spread-1 {
	//     z-index: 2;

	//     .page.left {
	//       transform: rotateY(0deg);
	//     }

	//     .page.right {
	//       transform: rotateY(-180deg);
	//     }

	//     .page-turn {
	//       animation-name: page-turn-reveal, page-turn-breathe;
	//     }

	//     .page-turn-tip {
	//       animation-name: page-turn-tip-reveal, page-turn-tip-breathe;
	//     }
	//   }
	//   .spread-2 {
	//     z-index: 2;

	//     .page.left {
	//       transform: rotateY(0deg);
	//     }

	//     .page.right {
	//       transform: rotateY(-180deg);
	//     }

	//     .page-turn {
	//       animation-name: page-turn-reveal, page-turn-breathe;
	//     }

	//     .page-turn-tip {
	//       animation-name: page-turn-tip-reveal, page-turn-tip-breathe;
	//     }
	//   }
	//   .spread-3 {
	//     z-index: 2;

	//     .page.left {
	//       transform: rotateY(0deg);
	//     }

	//     .page.right {
	//       transform: rotateY(-180deg);
	//     }

	//     .page-turn {
	//       animation-name: page-turn-reveal, page-turn-breathe;
	//     }

	//     .page-turn-tip {
	//       animation-name: page-turn-tip-reveal, page-turn-tip-breathe;
	//     }
	//   }
	//   .spread-4 {
	//     z-index: 3;

	//     .page { filter: none; }

	//     .page.left {
	//       transform: rotateY(0deg);
	//     }
	//   }
	// }
}

@media only screen and (max-width: 567px) {
	.book {
		height: 70vw;

		.spread .page .body-text {
			margin: 1em 0;
		}

		.spread-login .page .body-text,
		.spread-thank-you .page .body-text {
			width: 70%;
		}
	}
}
</style>

<script>
import axios from 'axios';

const baseURL = process.env.NODE_ENV === 'development' ? '//localhost:3000/guests/' : 'guests/';
//  process.env.NODE_ENV === 'development' ? 'https://jennandsteve.ca/guests/' : 'guests/'

export default {
	data() {
		return this.initialState();
	},
	mounted() {
		this.initialCamera();
		// this.focusInput('id');
		this.lookupGuest();
	},
	methods: {
		focusInput(i) {
			this.$refs[i].focus();
		},
		prev(i) {
			this.step--;
			this.focusInput(i);
		},
		next(i) {
			this.step++;
			this.cameraPan();
			this.focusInput(i);
		},
		initialState() {
			return {
				step: 1,
				errorMessage: '',
				guest: [],
			};
		},
		reset() {
			Object.assign(this.$data, this.initialState());
		},
		lookupGuest() {
			const linkID = new URLSearchParams(window.location.search).get('linkid');
			console.log(linkID);
			if (linkID) {
				axios
					.get(`${baseURL}${linkID}`)
					.then((response) => {
						this.guest = response.data;
					})
					.catch((error) => {
						this.errorMessage = error.message;
					});
			} else {
				this.errorMessage = 'Please enter an ID.';
			}
		},
		modifyGuest() {
			axios
				.put(`${baseURL}${this.guest.id}`, this.guest)
				.then((response) => {
					this.next();
				})
				.catch((error) => {
					console.log(error);
				});
		},
		cameraPan() {
			const app = document.getElementById('app');

			app.classList.remove('pan', 'right');
			app.classList.add('zoom-out');

			setTimeout(function() {
				app.classList.remove('zoom-out');
				app.classList.add('pan', 'left');
			}, 2500);

			setTimeout(function() {
				app.classList.remove('left');
				app.classList.add('right');
			}, 5000);
		},
		initialCamera() {
			const app = document.getElementById('app');

			setTimeout(function() {
				app.classList.add('pan', 'right');
			}, 2500);
		},
	},
};
</script>
